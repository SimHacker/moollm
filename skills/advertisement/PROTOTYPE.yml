# Advertisement Skill Prototype
# Objects announce what they can do — The Sims style

skill: advertisement
description: "Objects broadcast available actions, scored by context"
origin: "SimAntics — The Sims behavioral engine"

# Advertisement structure
advertisement_schema:
  action: string          # What the action is called
  description: string     # Human-readable explanation
  preconditions: list     # What must be true to enable
  score: number           # Base relevance score (0-100)
  score_if: string        # Condition that modifies score
  satisfies: list         # What needs/goals this addresses

# Example object with advertisements
example_object:
  name: workbench
  type: object
  advertisements:
    - action: CRAFT
      description: "Build something from materials"
      preconditions: [has_materials, has_skill]
      score: 80
      score_if: "goal == 'build'"
      satisfies: [productivity, creativity]
      
    - action: EXAMINE
      description: "Look at blueprints and tools"
      preconditions: []
      score: 50
      satisfies: [curiosity, planning]
      
    - action: ORGANIZE
      description: "Tidy up the workspace"
      preconditions: []
      score: 30
      score_if: "clutter > 0.5"
      satisfies: [order]
      
    - action: MORE
      description: "Show more options..."
      preconditions: []
      score: 20
      score_if: "always"
      satisfies: [exploration]

# Scoring algorithm
scoring:
  base: "Start with action's base score"
  modifiers:
    - "Apply score_if conditions"
    - "Boost if satisfies current goals"
    - "Reduce if preconditions barely met"
    - "Boost if character needs align"
  output: "Ranked list of actions"

# Autonomous selection
autonomous_selection:
  process:
    - "Gather all advertisements from objects in room"
    - "Score each based on context"
    - "Select highest-scored action"
    - "Execute action"
  
  example: |
    Room objects: workbench, bookshelf, door
    Agent goals: build_prototype
    Agent state: fatigue=0.2, has_materials=true
    
    Scores:
      workbench.CRAFT: 80 + 20 (goal match) = 100
      bookshelf.READ: 70
      workbench.EXAMINE: 50
      door.EXIT: 40
      
    Selection: CRAFT at workbench

# Pie menu integration
pie_menu:
  display: "Top actions radiate from center"
  center: "Highest scored action (default)"
  order: "Clockwise by score"
  gesture: "Swipe toward action to select"

# SimAntics mapping
simantics_heritage:
  object_advertisement: "advertisements list"
  motive_scores: "score_if and satisfies"
  autonomous_ai: "agent selects highest"
  interaction_queue: "action_queue in room"

# HyperCard-style event bubbling
event_bubbling:
  description: |
    Clicking an advertised action triggers a symbolic event
    that bubbles up the containment tree and inheritance graph.
    
  containment_path:
    - object          # Where click happened
    - room            # Containing room
    - parent_room     # Parent directory
    - grandparent     # And so on...
    - world_root      # Top of spatial hierarchy
    
  inheritance_path:
    - object_prototype      # Object's prototype
    - prototype_prototype   # And so on...
    - root_prototype        # Base object type
    
  resolution:
    order: "containment first, then inheritance"
    winner: "first handler that responds"
    unhandled:
      - log_warning
      - trigger_bpip
      - default_handler
      
  room_intercept:
    description: "Rooms can handle events before objects"
    example: |
      # workshop/ROOM.yml
      handles:
        CRAFT: |
          Check skill requirements.
          Validate materials.
          Then delegate to object.
