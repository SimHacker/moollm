# Return Stack Skill Prototype
# Navigation history as continuation

skill: return-stack
description: "Treat navigation history as a first-class continuation"
origin: "Call stacks, browser history, HyperCard navigation"

# Commands
commands:
  ENTER:
    syntax: "ENTER <room>"
    effect: "Push current room to stack, enter new room"
    
  BACK:
    syntax: "BACK"
    effect: "Pop stack, return to previous room with context"
    
  FORWARD:
    syntax: "FORWARD"
    effect: "After BACK, re-enter the room you came from"
    
  HISTORY:
    syntax: "HISTORY"
    effect: "Display the return stack"
    
  BOOKMARK:
    syntax: "BOOKMARK <name>"
    effect: "Save current position with a name"
    
  GOTO:
    syntax: "GOTO <bookmark>"
    effect: "Jump to bookmarked position"
    
  STACK:
    syntax: "STACK"
    effect: "Show all tabs (parallel stacks)"
    
  FORK:
    syntax: "FORK"
    effect: "Create new tab from current position"
    
  TAB:
    syntax: "TAB <number>"
    effect: "Switch to specified tab"

# Stack structure
stack_entry:
  room: string        # Path to room
  entered: timestamp  # When entered
  context: object     # What you were doing there
    # active_task
    # selected_object
    # scroll_position
    # etc.

# Character state
character_navigation:
  return_stack: list      # Stack of previous rooms
  forward_stack: list     # Rooms after BACK
  bookmarks: map          # Named positions
  tabs: list              # Parallel stacks
  active_tab: number      # Current tab index

# Continuation semantics
continuation:
  description: |
    The return stack IS a continuation â€” a saved computation state.
    BACK doesn't just change location, it restores context.
    
  properties:
    - portable: "Stack stored in character inventory"
    - shareable: "Can save/load journey files"
    - forkable: "Branch from any point"
    - replayable: "Follow someone else's path"

# Example journey file
journey_file:
  format: journey.yml
  contents:
    traveler: "explorer"
    date: "2024-01-15"
    path:
      - room: ./lobby
        action: "Started exploration"
      - room: ./workshop
        action: "Examined blueprints"
        discovery: "Found hidden compartment"
      - room: ./storage
        action: "Retrieved materials"
      - room: ./workshop
        action: "Crafted tool"
    outcome: "Successfully built prototype"
