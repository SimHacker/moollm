# CARD.yml ‚Äî Image Mining
#
# Extract semantic resources from images.
# "I mine pixels for atoms. Reality is just compressed resources."

card:
  id: image-mining
  name: "Image Mining"
  type: [skill, vision, extraction, automation]
  emoji: ‚õèÔ∏èüì∑
  rarity: uncommon
  
  tagline: "Mine pixels for atoms. Your camera is a pickaxe."
  
  description: |
    Extract semantic resources from any image. Give the vision LLM
    a shopping list of what you want, it mines the image and returns
    quantities, intensities, and YAML Jazz observations.
    
    Resource types can be ANYTHING:
    - Objects, materials, colors, textures
    - Moods, emotions, atmosphere
    - Inferred smells, sounds, temperatures
    - Philosophical: meaning, symbolism, existence

# YAML JAZZ ‚Äî The Output Style
#
# YAML Jazz: Comments are SEMANTIC DATA, not just documentation!
# Structure is the melody. Comments are the improvisation.
# 
# RULES:
#   1. COMMENT LIBERALLY ‚Äî Every insight deserves a note
#   2. Observations go in `#` comments inline with values
#   3. Longer thoughts go in `notes:` fields
#   4. Metaphors, hunches, uncertainties ‚Äî CAPTURE THEM ALL
#   5. The LLM should "think out loud" in comments
#
# EXAMPLE:
#   gold:
#     quantity: 200           # Piled in mounds, some coins ancient
#     confidence: 0.9         # Clear visibility in torchlight
#     notes: |
#       Mix of Roman denarii and medieval florins.
#       Suggests centuries of accumulation ‚Äî this was a 
#       thieves' hoard, not a king's treasury.
#
# Comments make mining results RICHER and more USEFUL.
# An uncommented extraction is like a song without soul.

yaml_jazz:
  definition: |
    YAML Jazz treats comments as first-class semantic data.
    Structure provides the backbone; comments provide the insight.
    LLMs reading YAML Jazz get BOTH the data AND the reasoning.
  principles:
    - "Comments are not optional ‚Äî they ARE the value"
    - "Inline comments for quick observations"
    - "notes: fields for longer thoughts"
    - "Capture confidence, hunches, metaphors"
    - "Think out loud ‚Äî the reader benefits from your reasoning"
  encouragement: |
    COMMENT EVERYTHING. When you mine an image:
    - Why did you estimate that quantity?
    - What visual cues led to this inference?
    - What's uncertain? What surprised you?
    - What metaphors capture the essence?
    
    The best mining results read like poetry annotated by a geologist.

# OPERATION MODES

modes:
  native:
    description: "LLM with vision reads protocol, looks at image, mines directly"
    requires: "Vision-capable LLM (Cursor, Claude, GPT-4V, Gemini)"
    how: |
      1. Include PROTOCOL.md in context (or just this CARD.yml)
      2. Point LLM at image path or paste image
      3. Provide shopping list of resources
      4. LLM outputs YAML Jazz extraction ‚Äî COMMENT LIBERALLY!
    tier: 0  # No tools needed, just knowledge!
    
  tool:
    description: "Use mine.py for automation or external LLM calls"
    requires: "Python, httpx, API keys"
    how: |
      mine.py image.jpg gold,gems,danger --depth philosophical
    tier: 2  # Script execution
    
  mcp:
    description: "Expose as MCP tool for any orchestrator"
    parameters:
      image: "path or base64"
      resources: "array of resource types"
      depth: "surface | deep | sensations | philosophical | full"

# PROTOCOL FILE (for context injection)

protocol:
  file: PROTOCOL.md
  purpose: "Concise mining instructions for LLMs"
  include_when: "LLM needs to mine but doesn't have mine.py"

# ENVIRONMENT VARIABLES

environment:
  OPENAI_API_KEY:
    enables: openai
    models: [gpt-4o, gpt-4o-mini]
    
  GOOGLE_API_KEY:
    enables: google  
    models: [gemini-2.0-flash, gemini-1.5-pro]
    
  ANTHROPIC_API_KEY:
    enables: anthropic
    models: [claude-3.5-sonnet, claude-3-opus]

# TOOLS

tools:
  required: [read_file, write_file]
  optional: [run_terminal_cmd]

tier: 2  # May execute scripts

# SISTER SCRIPT

script:
  name: mine.py
  path: skills/image-mining/mine.py
  
  commands:
    mine:
      description: "Extract resources from image"
      usage: "mine.py IMAGE [RESOURCES] [OPTIONS]"
      examples:
        - "mine.py treasure.jpg"
        - "mine.py photo.jpg --depth philosophical"
        - "mine.py scene.jpg gold,gems,danger,mood"
        - "mine.py photo.jpg --resources schema.yml"
        - "cat wanted.yml | mine.py photo.jpg -"
        
    scan:
      description: "Quick preview of mineable resources"
      usage: "mine.py scan IMAGE"
      
    schema:
      description: "Output example shopping list"
      usage: "mine.py schema --depth LEVEL"
      
    providers:
      description: "List available vision providers"
      usage: "mine.py providers"
      
  depth_levels:
    surface: "Objects, materials, colors visible"
    deep: "Hidden meanings, emotions, atmosphere"
    sensations: "Colors (hex), textures, smells, sounds"
    philosophical: "Meaning, symbolism, existence"
    full: "All depth levels combined"

# RESOURCE CATEGORIES

resource_types:
  materials:
    description: "Physical resources"
    examples: [iron-ore, copper-ore, wood, stone, water]
    
  organics:
    description: "Living/once-living resources"
    examples: [leaves, seeds, fish, bone, feathers]
    
  precious:
    description: "Valuable resources"
    examples: [gold, gems, artifacts, rare-elements]
    
  sensations:
    description: "Colors, textures, implied senses"
    examples: [sunset-orange, rough-wood, fresh-bread-aroma, warmth]
    
  abstract:
    description: "Conceptual resources"
    examples: [knowledge, emotions, mood, atmosphere, time]
    
  philosophical:
    description: "Deep resources (high depth required)"
    examples: [existence, narrative, mortality, beauty, meaning]

# METHODS

methods:
  MINE:
    description: "Extract resources from image"
    signature: "MINE [image] (WITH [shopping-list]) (AT [depth])"
    parameters:
      image: "Image file to mine"
      shopping_list: "Resource types to extract"
      depth: "surface | deep | sensations | philosophical | full"
    output: "YAML Jazz with quantities, intensities, observations"
    invoked_by: [player, script]
    
  SCAN:
    description: "Preview yields without full extraction"
    signature: "SCAN [image]"
    output: "Quick resource preview"
    invoked_by: [player]
    
  PROSPECT:
    description: "Detect mineable resources nearby"
    signature: "PROSPECT [direction|DEEP]"
    output: "List of potential mining targets"
    invoked_by: [player]

# MINING MECHANICS

mechanics:
  exhaustion:
    description: "Images can be mined multiple times until depleted"
    fields:
      total: "Total resources available"
      remaining: "Resources not yet extracted"
      per_turn: "Max extraction per mining operation"
      exhausted: "Boolean, true when fully mined"
      
  parallel_extraction:
    description: "Vision LLM extracts all requested resources in one pass"
    note: "Shopping list + image ‚Üí parallel object recognition"
    
  yaml_jazz_output:
    description: "Comments are semantic data, not just documentation"
    rule: "COMMENT EVERYTHING ‚Äî observations, hunches, metaphors, uncertainties"
    example: |
      gold:
        quantity: 150       # Piles of coins, some ancient
        confidence: 0.85    # Clear in torchlight, some obscured by shadow
        notes: |
          Mix of eras ‚Äî Roman denarii alongside medieval florins.
          This wasn't a king's treasury. This was a thief's hoard,
          accumulated over centuries. The dust says no one's been here
          in a very long time. Except whatever left those footprints.

# EXAMPLE OUTPUT

example_output: |
  # Mining results for treasure-room.jpg
  # Depth: full
  # Provider: openai/gpt-4o
  # 
  # YAML JAZZ: Comments are data! Think out loud!
  
  resources:
    gold:
      quantity: 150           # Piled in mounds ‚Äî not scattered, PLACED
      confidence: 0.85        # Torchlight glints clearly off the metal
      notes: |
        Mix of Roman denarii and medieval florins. Centuries of
        accumulation. This isn't a king's orderly treasury ‚Äî this is
        a thieves' hoard. Generations of stolen wealth, piled and
        forgotten. The dust layer says nobody's touched it in ages.
      
    danger:
      intensity: 0.7          # Not immediate, but PRESENT
      confidence: 0.75        # Hard to see into the corners
      sources:
        - "Skeleton in corner ‚Äî previous seeker, didn't make it"
        - "Shadows too dark for natural torchlight ‚Äî something absorbs"
        - "Dust undisturbed except ONE trail ‚Äî something still comes here"
      notes: "This hoard is guarded. Or cursed. Probably both."
      
    nostalgia:
      intensity: 0.4          # Whisper of lost civilizations
      confidence: 0.6         # Subjective, but the coins evoke it
      notes: "Who were they? Where did this come from? All gone now."
      
    dominant_colors:
      - name: "treasure-gold"
        hex: "#FFD700"
        coverage: 0.4         # Catches the eye first ‚Äî that's the point
      - name: "shadow-purple"
        hex: "#2D1B4E"
        coverage: 0.3         # Where the danger lives
      - name: "warning-red"
        hex: "#8B0000"
        coverage: 0.1         # Dried blood? Rust? Both?
        
    implied_smells:
      - dust                  # Centuries of it
      - old metal             # Copper, bronze, the tang of coins
      - something rotting     # Not recent, but not ancient either
      
  exhausted: false
  mining_notes: |
    Rich lode for material and philosophical mining.
    The image is ABOUT greed and its costs. The skeleton says everything.
    Deeper mining would yield mortality, passage of time, hubris.
    
    # Meta-observation: This image wants to be a warning.
    # "Here lies what you seek ‚Äî and what happens when you find it."

# STATE

state:
  mined_images: { type: array }
  last_extraction: { type: object }

# ADVERTISEMENTS

advertisements:
  MINE_IMAGE:
    score: 95
    condition: "Have image, want semantic resources"
  EXTRACT_COLORS:
    score: 90
    condition: "Need color palette from image"
  PHILOSOPHICAL_MINING:
    score: 85
    condition: "Extract deep meaning from visual"

# RELATED

see_also:
  - skills/visualizer         # Creates images to mine
  - skills/logistic-container # Stores mined resources
  - skills/postal             # Camera integration
  - skills/adventure          # World integration

# LINEAGE

lineage:
  parent: [decompose, visualizer]
  inspiration: ["Minecraft mining", "Photography as extraction"]
  philosophy: |
    Every image is compressed information.
    Mining decompresses it into resources.
    Your camera is a pickaxe for reality.
