# ğŸ¤”ğŸ’­ THOUGHTFUL-COMMITMENT
#
# "Commits should tell the story of why, not just what."
#
# Git commits PERSIST ephemeral Cursor state into permanent history.
# cursor-mirror sees the NOW. git commit FREEZES it into FOREVER.

skill:
  name: thoughtful-commitment
  version: 1.0.0
  emoji: "ğŸ¤”ğŸ’­"
  tagline: "Commits that remember why"
  config_dir: ".moollm/skills/thoughtful-commitment"
  
  description: |
    Transform mechanical commits into narrative records.
    Composes cursor-mirror + git + shell.

# FILES
files:
  docs:
    - SKILL.md                         # Full protocol + philosophy
    - README.md                        # Landing page
  examples:
    - examples/git-commands.yml        # Git archaeology
    - examples/commit-messages.yml     # Example commits
    - examples/shell-patterns.yml      # Data pipelines

# INTERFACE
tier: 2
protocol: THOUGHTFUL-COMMITMENT

allowed_tools:
  - read_file
  - write_file
  - list_dir
  - run_terminal_cmd
  - grep

related:
  - cursor-mirror      # Introspection engine
  - trekify            # Privacy masking
  - session-log        # Narrative storage

tags: [git, commits, narrative, provenance, introspection, composability]

# ADVERTISEMENTS â€” When to invoke this skill
advertisements:
  - id: COMMIT
    trigger: "user wants to commit with context"
    conditions:
      - "staged changes exist"
      - "user asks for thoughtful/narrative commit"
    score: 0.9
    
  - id: EXPLAIN
    trigger: "user asks why a commit was made"
    conditions:
      - "commit hash provided"
      - "user wants reasoning behind change"
    score: 0.8
    
  - id: BLAME
    trigger: "user asks who wrote code and why"
    conditions:
      - "file path provided"
      - "user wants attribution + reasoning"
    score: 0.85
    
  - id: ARCHAEOLOGY
    trigger: "user wants history of file/pattern"
    conditions:
      - "target path or pattern provided"
      - "user exploring evolution"
    score: 0.8

# METHODS â€” Signatures only, see SKILL.md for details
methods:

  COMMIT:
    description: "Create thoughtful commit with narrative context"
    params: [files, story, detail, focus, include_thinking]
    returns: [commit_id, message, thinking_link]
    
  EXPLAIN:
    description: "Find thinking that led to existing commit"
    params: [commit]
    returns: [commit_message, thinking_blocks, user_request, tool_calls]
    
  NARRATIVE:
    description: "Generate narrative commit message from context"
    params: [diff_summary, perspective, detail]
    returns: [message, sections]
    
  BLAME:
    description: "Who wrote each line, when, and why?"
    params: [path, lines, follow_renames]
    returns: [lines, commits, authors, timeline]
    
  ARCHAEOLOGY:
    description: "Deep dig into file/pattern history"
    params: [target, mode, since]
    returns: [evolution, milestones, contributors, linked_sessions]
    
  HISTORY:
    description: "Narrative timeline of a path"
    params: [path, depth, include_thinking]
    returns: [timeline]
    
  PLAN-MERGE:
    description: "Understand what merge will bring"
    params: [source, target, detail]
    returns: [commits_to_merge, files_affected, potential_conflicts, narrative]
    
  PLAN-CHERRY-PICK:
    description: "Plan surgical commit extraction"
    params: [commits, target]
    returns: [commits, order, warnings, commands]
    
  DEEP-COMMIT:
    description: "Mine session for technical analytics"
    params: [composer, commit_range]
    returns: [raw_metrics, tool_distribution, thinking_analysis, verification_commands]

  LINK:
    description: "Link commit to cursor-mirror events"
    params: [commit, events]
    returns: [linked, reference]

  CONTEXT-FOCUS:
    description: "Analyze what went into context for a call"
    composes_with: cursor-mirror
    params: [composer, event_id]
    returns: [files_read, snippets, conversation, rules, total_tokens]
    output_tag: "ğŸªŸ"

# USER CONFIG â€” Override defaults
user_config:
  location: ".moollm/skills/thoughtful-commitment/config.yml"
  schema:
    emojis: { type: boolean, default: true }
    detail_default: { type: integer, range: [1,5], default: 3 }
    focus_default: { type: array, default: [technical] }

# QUICK REFERENCE
detail_levels:
  1: "terse (~10 tokens)"
  2: "brief (~50 tokens)"
  3: "standard (~100 tokens)"
  4: "detailed (~300 tokens)"
  5: "comprehensive (~500+ tokens)"

focus_areas: [technical, narrative, process, provenance, changelog, metrics]

# EMOJI SIGNATURE
signature: "ğŸ¤”ğŸ’­"

# THOUGHT STREAM TAGGING
# Every line of output prefixed with: <signature> <category>
# Creates a visual stream showing the reasoning process
thought_stream:
  format: "ğŸ¤”ğŸ’­ <category> <content>"
  
  tags:
    prompt: "ğŸ“"       # User's request / background context
    context: "ğŸªŸ"      # Context window assembly (what went in)
    thinking: "ğŸ§ "     # LLM reasoning
    tool: "ğŸ”§"         # Tool call
    result: "ğŸ“¤"       # Tool result
    insight: "ğŸ’¡"      # Key realization
    decision: "ğŸ”€"     # Choice made
    change: "ğŸ“"       # File modification
    warning: "âš ï¸"      # Caveat / risk
  
  example_stream: |
    ğŸ¤”ğŸ’­ ğŸ“ User asked to refactor the auth module
    ğŸ¤”ğŸ’­ ğŸ§  Need to understand current structure first
    ğŸ¤”ğŸ’­ ğŸ”§ Read auth/session.ts
    ğŸ¤”ğŸ’­ ğŸ“¤ Found race condition in line 47
    ğŸ¤”ğŸ’­ ğŸ§  The cookie check races with token refresh
    ğŸ¤”ğŸ’­ ğŸ’¡ Adding await will fix the sequencing
    ğŸ¤”ğŸ’­ ğŸ”€ Chose await over mutex (simpler)
    ğŸ¤”ğŸ’­ ğŸ“ Modified auth/session.ts
    ğŸ¤”ğŸ’­ ğŸ§  Should add a test for this
    ğŸ¤”ğŸ’­ ğŸ”§ Write auth/session.test.ts

# OUTPUT STRUCTURE
output_structure: |
  1. ğŸ‘¤ User's prompt (head position)
  2. ---
  3. ğŸ¤”ğŸ’­ ğŸ§  / ğŸ”§ / ğŸ’¡ ... thought stream

# COMPOSES WITH
composes_with:
  cursor-mirror: "introspection (thinking, tools, transcripts)"
  git: "version control (commits, blame, log)"
  shell: "data processing (grep, awk, pipelines)"
  trekify: "privacy masking"
