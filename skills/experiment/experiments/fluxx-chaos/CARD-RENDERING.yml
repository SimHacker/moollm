# Card Rendering Specification
# MOOLLM Trading Card System
#
# Composable SVG + PNG elements assembled into trading cards
# Like Magic: The Gathering or Pokemon ‚Äî artistic, collectible, playable
#
# Philosophy: Define elements once, compose infinitely

meta:
  version: "1.0"
  format: "Trading Card"
  dimensions:
    width: 750   # pixels at 300dpi = 2.5 inches
    height: 1050 # pixels at 300dpi = 3.5 inches
    bleed: 36    # pixels for print bleed
    safe_zone: 54 # keep critical content inside this margin
    
  export_formats:
    - svg      # Vector, infinite scale
    - png      # Raster, transparent
    - webp     # Web optimized
    - pdf      # Print ready
    
  two_sided: true
  back_consistent_per_deck: true

# LAYER STACK ‚Äî Bottom to Top Compositing Order

layer_stack:
  # Compositing order (bottom ‚Üí top)
  layers:
    0: background       # Solid color or texture
    1: frame_base       # Card type border/frame
    2: art_box          # Main illustration area
    3: art_content      # The actual artwork (emoji, generated, custom)
    4: frame_overlay    # Frame details that sit on top of art
    5: text_boxes       # Name bar, rules box, flavor box
    6: text_content     # Actual text rendered
    7: symbols          # Type icons, mana cost, set symbol
    8: badges           # Karma, rarity, special indicators
    9: foil_effects     # Optional shine/holographic overlay
    
  # Each layer can be:
  #   - SVG element (vector, scalable)
  #   - PNG with transparency
  #   - Procedurally generated
  #   - AI-generated (with prompt)

# FRAME TEMPLATES ‚Äî By Card Type

frame_templates:

  keeper:
    name: "Keeper Frame"
    color_scheme:
      primary: "#2E7D32"      # Forest green
      secondary: "#81C784"    # Light green
      accent: "#FFD700"       # Gold trim
      text_bg: "#F1F8E9"      # Cream
    frame_svg: "frames/keeper-frame.svg"
    art_box:
      x: 54
      y: 120
      width: 642
      height: 420
      shape: "rounded_rect"
      corner_radius: 24
    name_box:
      x: 54
      y: 54
      width: 642
      height: 60
    rules_box:
      x: 54
      y: 560
      width: 642
      height: 280
    flavor_box:
      x: 54
      y: 860
      width: 642
      height: 120
    type_line:
      x: 54
      y: 540
      width: 642
      height: 24
      
  goal:
    name: "Goal Frame"
    color_scheme:
      primary: "#AD1457"      # Deep pink
      secondary: "#F48FB1"    # Light pink
      accent: "#FFD700"       # Gold trim
      text_bg: "#FCE4EC"      # Light pink cream
    frame_svg: "frames/goal-frame.svg"
    # Goal has special "requires" area
    requires_box:
      x: 54
      y: 560
      width: 642
      height: 200
      # Shows keeper symbols needed
    art_box:
      x: 54
      y: 120
      width: 642
      height: 420
      
  action:
    name: "Action Frame"
    color_scheme:
      primary: "#1565C0"      # Deep blue
      secondary: "#64B5F6"    # Light blue
      accent: "#FFD700"       # Gold trim
      text_bg: "#E3F2FD"      # Light blue cream
    frame_svg: "frames/action-frame.svg"
    # Action has larger rules box, smaller art
    art_box:
      x: 54
      y: 120
      width: 642
      height: 320
    rules_box:
      x: 54
      y: 460
      width: 642
      height: 360
      
  new_rule:
    name: "New Rule Frame"
    color_scheme:
      primary: "#F9A825"      # Amber
      secondary: "#FFF176"    # Light yellow
      accent: "#795548"       # Brown trim
      text_bg: "#FFFDE7"      # Cream yellow
    frame_svg: "frames/rule-frame.svg"
    # Rules have persistent effect indicator
    rule_type_badge:
      x: 640
      y: 54
      size: 60
      # Shows: draw, play, hand_limit, keeper_limit, special
      
  creeper:
    name: "Creeper Frame"
    color_scheme:
      primary: "#212121"      # Near black
      secondary: "#616161"    # Dark gray
      accent: "#B71C1C"       # Blood red
      text_bg: "#424242"      # Dark gray
      text_color: "#FFFFFF"   # White text!
    frame_svg: "frames/creeper-frame.svg"
    # Creepers have warning stripe
    warning_stripe:
      pattern: "diagonal_hazard"
      colors: ["#B71C1C", "#212121"]
      
  dealer_mode:
    name: "Cosmic Dealer Frame"
    color_scheme:
      primary: "#4A148C"      # Deep purple
      secondary: "#9C27B0"    # Purple
      accent: "#FFD700"       # Gold stars
      text_bg: "#F3E5F5"      # Light purple
    frame_svg: "frames/dealer-frame.svg"
    # Dealer cards have cosmic background
    cosmic_overlay: "effects/starfield.png"
    
  character:
    name: "Character Frame"
    color_scheme:
      primary: "#BF360C"      # Deep orange
      secondary: "#FF8A65"    # Light orange
      accent: "#FFD700"       # Gold
      text_bg: "#FBE9E7"      # Cream orange
    frame_svg: "frames/character-frame.svg"
    # Character cards have portrait-focused art box
    art_box:
      x: 120
      y: 100
      width: 510
      height: 450
      shape: "oval"  # Portrait oval!

# SYMBOL LIBRARY ‚Äî Reusable Icons

symbols:

  # Card Type Icons (for type line)
  type_icons:
    keeper:
      svg: "symbols/type-keeper.svg"
      fallback_emoji: "üèÜ"
      description: "Trophy/gem icon"
    goal:
      svg: "symbols/type-goal.svg"
      fallback_emoji: "üéØ"
      description: "Target/bullseye"
    action:
      svg: "symbols/type-action.svg"
      fallback_emoji: "‚ö°"
      description: "Lightning bolt"
    new_rule:
      svg: "symbols/type-rule.svg"
      fallback_emoji: "üìú"
      description: "Scroll"
    creeper:
      svg: "symbols/type-creeper.svg"
      fallback_emoji: "üëª"
      description: "Ghost/skull"
      
  # Rule Type Badges
  rule_badges:
    draw:
      svg: "symbols/rule-draw.svg"
      fallback_emoji: "üÉè"
      color: "#1565C0"
    play:
      svg: "symbols/rule-play.svg"
      fallback_emoji: "‚ñ∂Ô∏è"
      color: "#2E7D32"
    hand_limit:
      svg: "symbols/rule-hand.svg"
      fallback_emoji: "‚úã"
      color: "#F9A825"
    keeper_limit:
      svg: "symbols/rule-keeper.svg"
      fallback_emoji: "üì¶"
      color: "#795548"
    special:
      svg: "symbols/rule-special.svg"
      fallback_emoji: "‚ú®"
      color: "#9C27B0"
      
  # Karma Indicators
  karma:
    positive:
      svg: "symbols/karma-plus.svg"
      fallback: "+N"
      color: "#4CAF50"
    negative:
      svg: "symbols/karma-minus.svg"
      fallback: "-N"
      color: "#F44336"
    neutral:
      svg: "symbols/karma-neutral.svg"
      fallback: "‚öñÔ∏è"
      color: "#9E9E9E"
      
  # Dealer Mode Icons
  dealer_modes:
    random:
      svg: "symbols/dealer-random.svg"
      emoji: "üé≤"
    dramatic:
      svg: "symbols/dealer-dramatic.svg"
      emoji: "üé≠"
    karma:
      svg: "symbols/dealer-karma.svg"
      emoji: "‚öñÔ∏è"
    ironic:
      svg: "symbols/dealer-ironic.svg"
      emoji: "üé™"
    comedy:
      svg: "symbols/dealer-comedy.svg"
      emoji: "ü§°"
    dynamic:
      svg: "symbols/dealer-dynamic.svg"
      emoji: "üåä"
    fafo:
      svg: "symbols/dealer-fafo.svg"
      emoji: "üé∞üíÄ"
    chaos:
      svg: "symbols/dealer-chaos.svg"
      emoji: "üåÄüíÄüåÄ"
    prescient:
      svg: "symbols/dealer-prescient.svg"
      emoji: "üîÆ"
      
  # Expansion/Set Symbols
  set_symbols:
    fluxx_4_0:
      svg: "symbols/set-fluxx.svg"
      name: "Base Fluxx"
    amsterdam:
      svg: "symbols/set-amsterdam.svg"
      name: "Amsterdam"
      # Windmill or tulip
    consciousness:
      svg: "symbols/set-consciousness.svg"
      name: "Consciousness"
      # Third eye or mandala
    moollm_tech:
      svg: "symbols/set-moollm-tech.svg"
      name: "MOOLLM Tech"
      # Neural network or prompt icon
    moollm_characters:
      svg: "symbols/set-moollm-chars.svg"
      name: "MOOLLM Characters"
      # Silhouette group
    cosmic_dealers:
      svg: "symbols/set-cosmic.svg"
      name: "Cosmic Dealers"
      # Starfield or fate wheel
      
  # Bartle Types
  bartle:
    achiever:
      svg: "symbols/bartle-achiever.svg"
      emoji: "üèÜ"
      color: "#FFD700"
    explorer:
      svg: "symbols/bartle-explorer.svg"
      emoji: "üîç"
      color: "#2196F3"
    socializer:
      svg: "symbols/bartle-socializer.svg"
      emoji: "üé≠"
      color: "#E91E63"
    killer:
      svg: "symbols/bartle-killer.svg"
      emoji: "‚öîÔ∏è"
      color: "#F44336"
      
  # Autograph Mode
  autograph:
    signature_area:
      svg: "symbols/signature-lines.svg"
      description: "Faint lines for signatures"
    touch_counter:
      svg: "symbols/touch-counter.svg"
      description: "Small counter badge"

# TEXT STYLING

typography:

  fonts:
    name:
      family: "Beleren" # MTG-style, or fallback
      fallback: "Palatino, Georgia, serif"
      weight: "bold"
      size: 36
    type_line:
      family: "Beleren"
      fallback: "Palatino, Georgia, serif"
      weight: "normal"
      size: 18
      style: "italic"
    rules:
      family: "MPlantin" # MTG-style body
      fallback: "Plantin, Palatino, serif"
      weight: "normal"
      size: 22
      line_height: 1.3
    flavor:
      family: "MPlantin"
      fallback: "Plantin, Palatino, serif"
      weight: "normal"
      size: 18
      style: "italic"
      
  special_formatting:
    # In rules text, certain patterns get special treatment
    card_references:
      pattern: "\\[\\[(.+?)\\]\\]"  # [[Card Name]]
      style: "bold"
    keywords:
      pattern: "(Karma|Autograph|Dealer|Goal|Keeper|Creeper|Action|Rule)"
      style: "small-caps"
    numbers:
      pattern: "\\b(\\d+)\\b"
      style: "bold"
    emphasis:
      pattern: "\\*(.+?)\\*"
      style: "italic"

# ART GENERATION

art_generation:

  # Tier 1: Emoji Scaling
  emoji_mode:
    description: "Scale up card emoji as hero graphic"
    method: "svg_render"
    emoji_font: "Noto Color Emoji"
    scale: 8.0  # Emoji scaled 8x
    effects:
      - drop_shadow
      - subtle_glow
    suitable_for: "prototyping, digital play"
    
  # Tier 2: Stylized Emoji
  stylized_emoji:
    description: "Emoji with artistic background and effects"
    method: "composite"
    layers:
      - background_gradient
      - pattern_overlay
      - emoji_scaled
      - lighting_effects
    suitable_for: "polished digital, print-on-demand"
    
  # Tier 3: AI Generated (Legacy ‚Äî see prompt_pipeline for full system)
  ai_generated:
    description: "Full AI art generation per card"
    method: "image_model"
    prompt_template: |
      Trading card game illustration for "{{name}}"
      Style: {{art_style}}
      Card type: {{type}} ({{type_description}})
      Concept: {{flavor}}
      Emoji hint: {{emoji}}
      
      High quality, centered composition, fantasy card game art,
      dramatic lighting, detailed, professional illustration
      
    art_styles:
      keeper: "warm, inviting, valuable object or character"
      goal: "triumphant, aspirational, two elements combining"
      action: "dynamic, energetic, moment of impact"
      new_rule: "mystical, authoritative, glowing text/scroll"
      creeper: "dark, unsettling, ominous presence"
      character: "portrait style, personality showing through"
      
    suitable_for: "premium decks, collectible editions"
    
  # Tier 4: Custom Art
  custom:
    description: "Artist-commissioned illustrations"
    method: "external"
    asset_path: "art/custom/{{card_id}}.png"
    suitable_for: "professional products"

# PROMPT PIPELINE ‚Äî Multi-Stage Image Generation
#
# Philosophy: Images are not just outputs ‚Äî they're semantic artifacts.
# Generate with intention, mine for meaning, feed back into system.

prompt_pipeline:

  overview: |
    Four-stage process transforms card data into rich visual artifacts:
    
    1. SKELETON    ‚Üí Structure and references (what to show)
    2. SYNTHESIS   ‚Üí Resolve, curate, focus (how to show it)
    3. GENERATION  ‚Üí Image model execution (make it)
    4. MINING      ‚Üí Extract semantics back (what did we make?)
    
    The pipeline is bidirectional ‚Äî generated images inform future cards,
    character development, and narrative beats. Art generates meaning.

  # STAGE 1: Skeleton and References
  
  stage_1_skeleton:
    name: "Skeleton & References"
    purpose: "Build structured prompt scaffold with semantic placeholders"
    
    inputs:
      - card_data         # From game state YAML
      - card_type         # keeper, goal, action, etc.
      - expansion_context # Which deck/set
      - character_links   # If card references a character
      - related_cards     # Cards it pairs with (for goals)
      
    skeleton_template:
      # The bones ‚Äî filled in stage 2
      
      subject:
        primary: "{{~card.name}}"          # The main thing
        emoji_hint: "{{card.emoji}}"       # Visual seed
        archetype: "{{~card_type_archetype}}"
        
      references:
        visual_refs: []      # Art references to resolve
        character_refs: []   # Character files to pull from
        lore_refs: []        # Story/world context
        mood_refs: []        # Emotional tone sources
        
      composition:
        focus: null          # Where eye goes first
        depth: null          # Foreground/mid/back
        framing: null        # Close/medium/wide
        angle: null          # Eye level, low, high, dutch
        
      tells:
        # Visual storytelling elements
        body_language: null  # What pose/gesture says
        expression: null     # Face/mood readable
        environment: null    # Setting as character
        objects: null        # Props that tell story
        
      style:
        genre: null          # Fantasy, sci-fi, etc.
        medium: null         # Oil, digital, watercolor
        influences: []       # Artists/games/films
        era: null            # When does this feel like
        
    reference_types:
      # How references are notated in skeleton
      
      character_ref:
        syntax: "@character:{{id}}"
        example: "@character:don-hopkins"
        resolves_to: "Character YAML ‚Üí visual description, traits"
        
      card_ref:
        syntax: "@card:{{ref}}"
        example: "@card:fluxx-4.0:bread"
        resolves_to: "Other card data for combination art"
        
      mood_ref:
        syntax: "@mood:{{emotion}}"
        example: "@mood:triumphant"
        resolves_to: "Curated mood board keywords"
        
      lore_ref:
        syntax: "@lore:{{path}}"
        example: "@lore:moollm/society-of-mind"
        resolves_to: "World-building text ‚Üí visual interpretation"
        
      style_ref:
        syntax: "@style:{{name}}"
        example: "@style:art-nouveau"
        resolves_to: "Style guide ‚Üí keywords, colors, shapes"
        
    example_skeleton:
      # For card: Marvin Minsky (keeper)
      
      subject:
        primary: "Marvin Minsky"
        emoji_hint: "üß†"
        archetype: "Keeper ‚Äî valuable person/thing to possess"
        
      references:
        visual_refs:
          - "@photo:minsky-mit-1970s"     # Reference photo
          - "@style:academic-portrait"
        character_refs:
          - "@character:marvin-minsky"    # If we have YAML
        lore_refs:
          - "@lore:society-of-mind"
          - "@lore:k-lines"
        mood_refs:
          - "@mood:wise"
          - "@mood:mischievous"
          - "@mood:profound"
          
      composition:
        focus: "eyes and forehead"        # Mind-focus
        depth: "shallow ‚Äî intimate"
        framing: "medium close-up"
        angle: "slight low ‚Äî reverence"
        
      tells:
        body_language: "leaning forward, engaged"
        expression: "knowing smile, sparkling eyes"
        environment: "fragments of ideas floating"
        objects: "K-line diagram subtle in background"
        
      style:
        genre: "intellectual portrait"
        medium: "oil painting, rich darks"
        influences: ["Rembrandt", "trading card portraiture"]
        era: "timeless ‚Äî past wisdom, future relevance"

  # STAGE 2: Resolve, Synthesize, Curate
  
  stage_2_synthesis:
    name: "Resolve & Synthesize"
    purpose: "Expand references, curate for visual impact, focus the lens"
    
    operations:
      
      resolve_references:
        description: "Expand all @refs into actual content"
        process:
          - "Load character YAML ‚Üí extract visual_description, personality"
          - "Load lore files ‚Üí distill visual hooks"
          - "Load mood boards ‚Üí gather keywords"
          - "Load style guides ‚Üí pull techniques, palettes"
          
      synthesize_visuals:
        description: "Merge references into coherent visual direction"
        considerations:
          - "What's the ONE thing this image says?"
          - "What makes this card RECOGNIZABLE at thumbnail size?"
          - "What visual rhymes with the card's gameplay?"
          - "How does this fit the expansion's visual language?"
          
      curate_tells:
        description: "Choose the moments that tell the story"
        principles:
          - "Show, don't explain"
          - "The body knows before the mind"
          - "Environment IS character"
          - "Objects carry weight"
          - "Empty space speaks"
          
      focus_impressions:
        description: "What should the viewer FEEL?"
        emotional_vectors:
          keeper: "I want to have this / protect this"
          goal: "I can achieve this / this completes me"
          action: "This changes everything / moment of power"
          new_rule: "The world just shifted / new truth"
          creeper: "Unease / threat I must manage"
          character: "I know this person / they're real"
          
    pose_library:
      # Common poses and what they communicate
      
      power:
        - "arms crossed, chin up"           # Confidence
        - "leaning forward, hands on table" # Authority
        - "one hand raised, palm out"       # Command/stop
        - "seated, legs wide"               # Dominance
        
      wisdom:
        - "hand on chin, gaze distant"      # Contemplation
        - "slight smile, knowing eyes"      # Secret knowledge
        - "book open, finger on page"       # Discovery
        - "surrounded by symbols"           # Immersed in meaning
        
      action:
        - "mid-motion blur"                 # Speed
        - "just released ‚Äî follow-through"  # Impact
        - "about to strike ‚Äî tension"       # Anticipation
        - "dodge/lean ‚Äî reactive"           # Survival
        
      connection:
        - "reaching toward viewer"          # Invitation
        - "two figures mirroring"           # Resonance
        - "hands touching object together"  # Shared value
        - "back-to-back"                    # Alliance
        
      mystery:
        - "partially obscured face"         # Unknown
        - "emerging from shadow"            # Revealing
        - "looking away from viewer"        # Private
        - "reflected in surface"            # Double nature
        
    visual_tells_dictionary:
      # What objects/elements mean in card art
      
      light_sources:
        "from above": "divine, judgment, revelation"
        "from below": "unnatural, sinister, power"
        "from behind": "mystery, silhouette, destiny"
        "diffuse": "dreamlike, memory, possibility"
        "harsh": "truth, exposure, conflict"
        "warm": "comfort, home, value"
        "cool": "intellect, distance, technology"
        
      hands:
        "open palm up": "offering, receiving, peace"
        "closed fist": "power, resistance, contained"
        "pointing": "direction, accusation, focus"
        "touching face": "thought, doubt, deception"
        "clasped": "prayer, pleading, patience"
        "reaching": "desire, connection, almost"
        
      eyes:
        "direct gaze": "challenge, honesty, presence"
        "averted": "shame, mystery, planning"
        "upward": "hope, appeal, transcendence"
        "closed": "peace, denial, meditation"
        "narrowed": "suspicion, focus, cunning"
        
      background_elements:
        "clear/empty": "focus, simplicity, purity"
        "crowded": "chaos, wealth, overwhelm"
        "geometric": "order, technology, abstract"
        "organic": "nature, growth, life"
        "ruins": "past, loss, foundation"
        "construction": "future, building, progress"
        
    synthesis_output:
      # The resolved, focused prompt components
      
      visual_brief:
        one_sentence: "The essence in one line"
        thumbnail_read: "What you see at 50px"
        full_read: "What unfolds with study"
        
      scene_description:
        setting: "Where and when"
        subject: "Who/what, how positioned"
        action: "What's happening"
        atmosphere: "Light, mood, energy"
        
      style_direction:
        primary_style: "Main artistic approach"
        techniques: ["List of specific techniques"]
        palette: ["Color keywords or hex codes"]
        avoid: ["What NOT to do"]
        
      emotional_target:
        immediate: "First reaction"
        lingering: "What stays with you"
        gameplay_resonance: "How feeling matches mechanics"

  # STAGE 3: Generate
  
  stage_3_generation:
    name: "Image Generation"
    purpose: "Execute prompt through image model"
    
    prompt_assembly:
      # How synthesis output becomes final prompt
      
      structure: |
        [STYLE BLOCK]
        {{style_direction.primary_style}}
        Techniques: {{style_direction.techniques | join(", ")}}
        Palette: {{style_direction.palette | join(", ")}}
        
        [SCENE BLOCK]
        {{scene_description.setting}}
        {{scene_description.subject}}
        {{scene_description.action}}
        {{scene_description.atmosphere}}
        
        [COMPOSITION BLOCK]
        Framing: {{composition.framing}}
        Focus: {{composition.focus}}
        Depth: {{composition.depth}}
        
        [EMOTIONAL TARGET]
        This image should make the viewer feel: {{emotional_target.immediate}}
        Lingering impression: {{emotional_target.lingering}}
        
        [TECHNICAL]
        Trading card game illustration, 750x1050 aspect ratio
        High detail, centered composition, professional quality
        
        [AVOID]
        {{style_direction.avoid | join(", ")}}
        No text, no watermarks, no borders
        
    generation_params:
      model: "configurable"  # DALL-E 3, Midjourney, SDXL, etc.
      aspect_ratio: "5:7"    # Card proportions
      quality: "high"
      iterations: 4          # Generate options
      
    selection_criteria:
      # How to pick from generated options
      - "Clearest read at thumbnail"
      - "Strongest emotional hit"
      - "Best composition for card frame"
      - "Most distinctive silhouette"
      - "Least clich√© interpretation"
      
    post_processing:
      - "Color grade to match expansion palette"
      - "Ensure safe zone clearance"
      - "Add subtle vignette for frame integration"
      - "Export at multiple resolutions"

  # STAGE 4: Image Mining
  
  stage_4_mining:
    name: "Semantic Mining"
    purpose: "Extract meaning back from generated image"
    
    philosophy: |
      The generated image is not just output ‚Äî it's a new artifact
      with its own semantic weight. What did the image model "decide"
      that we didn't explicitly specify? What emerged? What does
      this image TELL us that we can feed back into the system?
      
      This is the round-trip: Data ‚Üí Prompt ‚Üí Image ‚Üí Data
      
    mining_operations:
      
      visual_inventory:
        description: "Catalog what's actually in the image"
        extracts:
          - objects_present      # What things exist
          - colors_dominant      # Actual palette used
          - composition_actual   # How it was framed
          - lighting_actual      # Light sources and quality
          - textures             # Surface qualities
          - negative_space       # What's NOT there
          
      emergent_semantics:
        description: "Meanings that emerged we didn't plan"
        questions:
          - "What symbols appeared we didn't request?"
          - "What relationships formed between elements?"
          - "What story does this tell beyond our brief?"
          - "What mood emerged vs. what we targeted?"
          - "What surprised us?"
          
      character_insights:
        description: "For character cards, what did we learn?"
        extracts:
          - personality_expressed  # What traits show
          - age_impression        # How old they feel
          - status_impression     # Social position
          - trustworthiness       # Can we trust them?
          - hidden_depths         # What's beneath surface
          
      gameplay_resonance:
        description: "Does the image match the mechanics?"
        assessment:
          - "Does this LOOK like a keeper/goal/action?"
          - "Does the energy match the card's effect?"
          - "Would you want to play this card?"
          - "Does it tell you what it does?"
          
      narrative_hooks:
        description: "Story opportunities the image creates"
        extracts:
          - "What question does this image ask?"
          - "What happened just before this moment?"
          - "What happens next?"
          - "Who else might be just outside the frame?"
          - "What secret does this image hold?"
          
    mining_output:
      # Structured data extracted from image
      
      image_facts:
        dominant_colors: ["#hex1", "#hex2", "#hex3"]
        composition_type: "central | rule-of-thirds | diagonal | etc"
        energy_level: "0-10 scale"
        complexity: "minimal | moderate | dense"
        
      emergent_tags:
        # Tags we didn't specify but image earned
        - "mysterious"
        - "technological"
        - "organic"
        # etc.
        
      character_profile_updates:
        # For character cards, amendments to character YAML
        visual_age: "appears 60s"
        visual_demeanor: "warm but guarded"
        signature_elements: ["bushy eyebrows", "knowing smile"]
        
      narrative_seeds:
        questions_raised: ["What is he looking at?"]
        implied_backstory: "Long career, many battles"
        future_hooks: ["The object in his hand..."]
        
      cross_references:
        # Cards this image visually connects to
        visual_siblings: ["card_ref_1", "card_ref_2"]
        thematic_pairs: ["goal that needs this keeper"]
        
    feedback_loop:
      # How mined data flows back into system
      
      to_card_data:
        - "Update card with emergent_tags"
        - "Add visual_signature for future consistency"
        - "Record dominant_colors for expansion palette"
        
      to_character_files:
        - "Amend CHARACTER.yml with visual discoveries"
        - "Add narrative_seeds to character story hooks"
        - "Update appearance section"
        
      to_future_generation:
        - "Add to style reference library"
        - "Record successful techniques"
        - "Build visual vocabulary for this character/type"
        
      to_narrative:
        - "Feed questions_raised to story generators"
        - "Use cross_references for plot connections"
        - "Mine implied_backstory for lore expansion"

  # EXAMPLE: Full Pipeline Run
  
  example_run:
    card: "moollm-inspirations:alan_kay"
    
    stage_1_output:
      subject:
        primary: "Alan Kay"
        emoji_hint: "üíª"
        archetype: "Keeper ‚Äî legendary figure to possess"
      references:
        visual_refs: ["@style:xerox-parc-aesthetic"]
        character_refs: ["@lore:dynabook-vision"]
        mood_refs: ["@mood:visionary", "@mood:playful"]
      composition:
        focus: "hands and eyes ‚Äî builder and seer"
        framing: "medium shot, slight tilt"
      tells:
        expression: "amused wisdom, seeing future"
        objects: "prototype device, child's drawing"
        
    stage_2_output:
      visual_brief:
        one_sentence: "The inventor who saw children as the future"
        thumbnail_read: "Warm figure, glowing device"
        full_read: "Gentle eyes seeing decades ahead"
      scene_description:
        setting: "Xerox PARC, golden hour light, late 1970s feel"
        subject: "Alan Kay, casual sweater, holding early tablet prototype"
        action: "Paused mid-explanation, showing something to someone below frame"
        atmosphere: "Warm, optimistic, the future being born"
      style_direction:
        primary_style: "Painterly realism, Norman Rockwell meets retrofuturism"
        techniques: ["soft edges", "warm shadows", "period-accurate tech"]
        palette: ["#F5DEB3", "#8B4513", "#87CEEB", "#FFD700"]
        avoid: ["too slick", "corporate", "cold"]
      emotional_target:
        immediate: "I want to learn from this person"
        lingering: "He knew something we're still figuring out"
        gameplay_resonance: "Keeper I'd protect, gives me an edge"
        
    stage_3_output:
      prompt_final: |
        Painterly realism, Norman Rockwell meets retrofuturism
        Soft edges, warm shadows, period-accurate technology
        
        Xerox PARC research lab, golden hour light streaming through windows
        Late 1970s aesthetic, warm wood and early computer equipment
        
        Alan Kay in casual cream sweater, holding an early tablet prototype
        that glows faintly with possibility. He's paused mid-explanation,
        looking toward someone just below frame with amused, knowing eyes.
        A child's drawing visible on a whiteboard behind him.
        
        Medium shot, slight Dutch tilt suggesting dynamic thinking.
        Focus on his hands cradling the device and his seeing-the-future eyes.
        
        This image should make the viewer feel: I want to learn from this person
        Lingering impression: He knew something we're still figuring out
        
        Trading card game illustration, professional quality
        AVOID: too slick, corporate feeling, cold lighting
        No text, no watermarks
        
      selected_image: "alan_kay_v3.png"  # Best of 4
      
    stage_4_output:
      image_facts:
        dominant_colors: ["#E8D4B8", "#6B4423", "#87CEEB"]
        composition_type: "slightly off-center, active"
        energy_level: 6
        complexity: "moderate"
      emergent_tags:
        - "paternal"
        - "hopeful"
        - "craftsman"
        - "time-traveler"
      character_profile_updates:
        visual_age: "mid-40s, timeless energy"
        visual_demeanor: "playful authority"
        signature_elements: ["that specific knowing smile", "hands that build"]
      narrative_seeds:
        questions_raised: ["What did that child draw?", "Who is he teaching?"]
        implied_backstory: "Many prototypes before, many to come"
        future_hooks: ["The Dynabook's journey continues..."]
      cross_references:
        visual_siblings: ["seymour_papert", "bret_victor"]
        thematic_pairs: ["goal:the_future_invented"]
        
    feedback_applied:
      - "Card updated with tags: paternal, hopeful, craftsman"
      - "Alan Kay visual signature recorded for consistency"
      - "Narrative hook 'What did that child draw?' added to lore queue"
      - "Cross-reference to Papert noted for visual cohesion"

# CARD BACKS

card_backs:

  default:
    name: "MOOLLM Standard Back"
    svg: "backs/moollm-standard.svg"
    layers:
      - solid_color: "#1A237E"  # Deep blue
      - pattern: "backs/pattern-circuits.svg"
      - logo: "backs/moollm-logo.svg"
      - border: "backs/border-ornate.svg"
      
  deck_variants:
    fluxx_chaos:
      name: "Fluxx Chaos Back"
      primary_color: "#4A148C"  # Purple
      pattern: "backs/pattern-swirl.svg"
      logo: "backs/fluxx-logo.svg"
      
    amsterdam_flux:
      name: "Amsterdam Flux Back"
      primary_color: "#FF6F00"  # Orange
      pattern: "backs/pattern-tulips.svg"
      logo: "backs/amsterdam-logo.svg"
      
    turing_chess:
      name: "Turing Chess Back"
      primary_color: "#212121"  # Near black
      pattern: "backs/pattern-chess.svg"
      logo: "backs/turing-logo.svg"
      
  customization_hooks:
    # Players can customize:
    - primary_color
    - pattern
    - personal_logo
    - name_text
    # But NOT:
    - overall_dimensions
    - back_is_different_per_card  # Must be consistent for hidden info!

# SPECIAL EFFECTS

effects:

  foil:
    description: "Holographic foil effect"
    svg_filter: "effects/foil-rainbow.svg"
    applied_to: ["rare", "legendary", "character"]
    
  glow:
    description: "Subtle outer glow"
    css_filter: "drop-shadow(0 0 8px {{color}})"
    applied_to: ["active_cards"]
    
  aged:
    description: "Worn/vintage look"
    overlay: "effects/aged-texture.png"
    blend_mode: "multiply"
    applied_to: ["cards_with_many_signatures"]
    
  legendary:
    description: "Gold trim, extra shine"
    frame_variant: "_legendary"
    applied_to: ["touch_count > 10"]

# COMPOSITION ENGINE

composition:

  # The compiler reads card data and produces composed images
  
  input:
    card_data:
      ref: "fluxx-4.0:bread"
      type: "keeper"
      name: "Bread"
      emoji: "üçû"
      flavor: "You can't have a sandwich without it."
      text: null
      special_ability: null
      signatures: [{player: "don", turn: 3, message: "Staff of life!"}]
      
  process:
    1: select_frame_template(card.type)
    2: render_background()
    3: generate_or_load_art(card.emoji, card.name, card.flavor)
    4: place_art_in_box()
    5: render_name(card.name)
    6: render_type_line(card.type, card.set)
    7: render_rules_text(card.text)
    8: render_flavor_text(card.flavor)
    9: place_symbols(card.type, card.karma_impact, card.set)
    10: apply_effects(card.rarity, card.touch_count)
    11: render_signatures_area(card.signatures)
    12: composite_all_layers()
    13: export_formats()
    
  output:
    files:
      - "cards/000-bread.svg"
      - "cards/000-bread.png"
      - "cards/000-bread-thumb.png"  # For deck views
      
# BATCH GENERATION

batch:

  # Generate all cards from game state
  
  input: "amsterdam-flux-000.yml"
  
  output_dir: "generated/amsterdam-flux/"
  
  generate:
    - all_card_fronts: "cards/"
    - deck_back: "back.svg"
    - card_sheet: "sheet.pdf"  # For print
    - sprite_atlas: "atlas.png"  # For web
    - manifest: "manifest.json"  # Card metadata
    
  sprite_atlas:
    columns: 16
    rows: 17  # 263 cards + back
    card_size: [150, 210]  # Thumbnail size
    # Web app loads atlas + manifest, renders from sprites
    
  print_sheet:
    cards_per_page: 9  # 3x3
    page_size: "letter"  # or A4
    cut_marks: true
    bleed: true

# WEB RENDERER

web_renderer:

  description: "In-browser card rendering"
  
  # Instead of pre-generating, render cards live
  
  technology: "SVG in DOM"
  
  advantages:
    - "Dynamic updates (signatures appear in real-time)"
    - "No image generation step"
    - "Infinite zoom"
    - "Animations native"
    
  components:
    CardFrame: "React/Svelte component for frame"
    CardArt: "Renders emoji or image"
    CardText: "Handles text layout and overflow"
    CardSymbols: "Positions badges and icons"
    CardStack: "Deck/hand rendering"
    
  animations:
    deal: "Card slides from deck to hand"
    play: "Card moves to play area with flip"
    steal: "Card drags from opponent"
    shuffle: "Deck riffles"
    signature: "Pen stroke animation when signed"
